// Generated by CoffeeScript 1.3.3
(function(){"use strict";var e,t,n,r,i,s,o,u,a,f,l,c,h;f=window,e=f.$||!1,i=!1,u=!0,l=document.createElement("div"),a=["Webkit","Moz","O","ms","Khtml"],n={transform:"transform",origin:"transformOrigin",transformStyle:"transformStyle",transitionProp:"transitionProperty",transitionDuration:"transitionDuration",transitionEasing:"transitionTimingFunction",perspective:"perspective",backface:"backfaceVisibility"},c=function(e){var t,n,r,i;if(l.style[e]!=null)return e;t=e.charAt(0).toUpperCase()+e.slice(1);for(r=0,i=a.length;r<i;r++){n=a[r];if(l.style[n+t]!=null)return n+t}return!1};for(o in n){h=n[o],n[o]=c(h);if(!n[o]){i&&console.warn("oriDomi: Browser does not support oriDomi"),u=!1;break}}n.gradientProp=function(){var e,t,n,r;for(n=0,r=a.length;n<r;n++){t=a[n],e="-"+t.toLowerCase()+"-linear-gradient",l.style.backgroundImage=""+e+"(left, #000, #fff)";if(l.style.backgroundImage.indexOf("gradient")!==-1)return e}return"linear-gradient"}(),n.transformProp=function(){var e;return e=n.transform.match(/(\w+)Transform/i)[1],e?"-"+e.toLowerCase()+"-transform":"transform"}(),n.transitionEnd=function(){switch(n.transitionProp){case"transitionProperty":return"transitionEnd";case"WebkitTransitionProperty":return"webkitTransitionEnd";case"MozTransitionProperty":return"transitionend";case"OTransitionProperty":return"oTransitionEnd";case"MSTransitionProperty":return"msTransitionEnd"}}(),s=function(e,t){var n;if(t!==Object(t))return i&&console.warn("oriDomi: Must pass an object to extend with"),e;e!==Object(e)&&(e={});for(n in t)e[n]==null&&(e[n]=t[n]);return e},r={vPanels:3,hPanels:3,perspective:1e3,shading:"hard",speed:700,oriDomiClass:"oridomi",shadingIntensity:1,easingMethod:"",showOnStart:!1,forceAntialiasing:!1},t=function(){function t(o,a){var l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,J,K;this.el=o,i&&console.time("oridomiConstruction");if(!u)return this.el;if(!(this instanceof t))return new oriDomi(this.el,this.settings);this.settings=s(a,r);if(this.el==null&&this.el.nodeType===1)return i&&console.warn("oriDomi: First argument must be a DOM element");R=this.settings,this.shading=R.shading,this.shadingIntensity=R.shadingIntensity,this.vPanels=R.vPanels,this.hPanels=R.hPanels,v=f.getComputedStyle(this.el),this.width=parseInt(v.width,10)+parseInt(v.paddingLeft,10)+parseInt(v.paddingRight,10)+parseInt(v.borderLeftWidth,10)+parseInt(v.borderRightWidth,10),this.height=parseInt(v.height,10)+parseInt(v.paddingTop,10)+parseInt(v.paddingBottom,10)+parseInt(v.borderTopWidth,10)+parseInt(v.borderBottomWidth,10),this.panelWidth=this.width/this.vPanels,this.panelHeight=this.height/this.hPanels,this.lastAngle=0,this.isFoldedUp=!1,this.anchors=["left","right","top","bottom"],this.lastAnchor=this.anchors[0],this.panels={},this.stages={},x=document.createElement("div"),x.style.width=this.width+"px",x.style.height=this.height+"px",x.style.display="none",x.style.position="absolute",x.style.padding="0",x.style.margin="0",x.style[n.perspective]=this.settings.perspective+"px",U=this.anchors;for(A=0,D=U.length;A<D;A++)l=U[A],this.panels[l]=[],this.stages[l]=x.cloneNode(!1),this.stages[l].className="oridomi-stage-"+l;if(this.shading){this.shaders={},z=this.anchors;for(O=0,P=z.length;O<P;O++)l=z[O],this.shaders[l]={},l==="left"||l==="right"?(this.shaders[l].left=[],this.shaders[l].right=[]):(this.shaders[l].top=[],this.shaders[l].bottom=[]);S=document.createElement("div"),S.style[n.transitionProp]="opacity",S.style[n.transitionDuration]=this.settings.speed+"ms",S.style[n.transitionEasing]=this.settings.easingMethod,S.style.position="absolute",S.style.width="100%",S.style.height="100%",S.style.opacity="0",S.style.top="0",S.style.left="0"}d=this.el.cloneNode(!0),d.classList.add("oridomi-content"),d.style.margin="0",d.style.position="relative",d.style.float="none",m=document.createElement("div"),m.className="oridomi-mask-h",m.style.position="absolute",m.style.overflow="hidden",m.style.width="100%",m.style.height="100%",m.style[n.transform]="translate3d(0, 0, 0)",m.appendChild(d),this.shading&&(T=S.cloneNode(!1),T.className="oridomi-shader-top",T.style.background=this._getShaderGradient("top"),h=S.cloneNode(!1),h.className="oridomi-shader-bottom",h.style.background=this._getShaderGradient("bottom"),m.appendChild(T),m.appendChild(h)),c=2,g=document.createElement("div"),g.className="oridomi-panel-h",g.style.width="100%",g.style.height=this.panelHeight+c+"px",g.style.padding="0",g.style.position="relative",g.style[n.transitionProp]=n.transformProp,g.style[n.transitionDuration]=this.settings.speed+"ms",g.style[n.transitionEasing]=this.settings.easingMethod,g.style[n.origin]="top",g.style[n.transformStyle]="preserve-3d",g.style[n.backface]="hidden",this.settings.forceAntialiasing&&(g.style.outline="1px solid transparent"),g.appendChild(m),W=["top","bottom"];for(M=0,H=W.length;M<H;M++){l=W[M];for(y=_=0,X=this.hPanels;0<=X?_<X:_>X;y=0<=X?++_:--_)w=g.cloneNode(!0),p=w.getElementsByClassName("oridomi-content")[0],l==="top"?(L=-(y*this.panelHeight),y===0?w.style.top="0":w.style.top=this.panelHeight+"px"):(w.style[n.origin]="bottom",L=-(this.hPanels*this.panelHeight-this.panelHeight*(y+1)),y===0?w.style.top=this.panelHeight*(this.vPanels-1)-c+"px":w.style.top=-this.panelHeight+"px"),p.style.top=L+"px",this.shading&&(this.shaders[l].top[y]=w.getElementsByClassName("oridomi-shader-top")[0],this.shaders[l].bottom[y]=w.getElementsByClassName("oridomi-shader-bottom")[0]),this.panels[l][y]=w,y!==0&&this.panels[l][y-1].appendChild(w);this.stages[l].appendChild(this.panels[l][0])}N=m.cloneNode(!0),N.className="oridomi-mask-v",this.shading&&(b=N.getElementsByClassName("oridomi-shader-top")[0],b.className="oridomi-shader-left",b.style.background=this._getShaderGradient("left"),E=N.getElementsByClassName("oridomi-shader-bottom")[0],E.className="oridomi-shader-right",E.style.background=this._getShaderGradient("right")),C=g.cloneNode(!1),C.className="oridomi-panel-v",C.style.width=this.panelWidth+c+"px",C.style.height="100%",C.style[n.origin]="left",C.appendChild(N),V=["left","right"];for(F=0,B=V.length;F<B;F++){l=V[F];for(y=I=0,J=this.vPanels;0<=J?I<J:I>J;y=0<=J?++I:--I)w=C.cloneNode(!0),p=w.getElementsByClassName("oridomi-content")[0],l==="left"?(k=-(y*this.panelWidth),y===0?w.style.left="0":w.style.left=this.panelWidth+"px"):(w.style[n.origin]="right",k=-(this.vPanels*this.panelWidth-this.panelWidth*(y+1)),y===0?w.style.left=this.panelWidth*(this.vPanels-1)-1+"px":w.style.left=-this.panelWidth+"px"),p.style.left=k+"px",this.shading&&(this.shaders[l].left[y]=w.getElementsByClassName("oridomi-shader-left")[0],this.shaders[l].right[y]=w.getElementsByClassName("oridomi-shader-right")[0]),this.panels[l][y]=w,y!==0&&this.panels[l][y-1].appendChild(w);this.stages[l].appendChild(this.panels[l][0])}this.el.classList.add(this.settings.oriDomiClass),this.el.style.padding="0",this.el.style.width=this.width+"px",this.el.style.height=this.height+"px",this.el.style.backgroundColor="transparent",this.el.style.backgroundImage="none",this.el.style.border="none",this.el.style.outline="none",this.stages.left.style.display="block",this.el.innerHTML="",K=this.anchors;for(q=0,j=K.length;q<j;q++)l=K[q],this.el.appendChild(this.stages[l]);this.settings.showOnStart&&(this.el.style.display="block",this.el.style.visibility="visible"),e&&(this.$el=e(this.el)),this._callback(this.settings),i&&console.timeEnd("oridomiConstruction")}return t.prototype._callback=function(e){var t,r=this;if(typeof e.callback=="function")return t=function(r){return r.currentTarget.removeEventListener(n.transitionEnd,t,!1),e.callback()},this.lastAngle===0?e.callback():this.panels[this.lastAnchor][0].addEventListener(n.transitionEnd,t,!1)},t.prototype._transform=function(e,t){var n,r;switch(this.lastAnchor){case"left":n=[0,1,0,e];break;case"right":n=[0,1,0,-e];break;case"top":n=[1,0,0,-e];break;case"bottom":n=[1,0,0,e]}return t&&(r=[1,1,1],n[0]=r[0],n[1]=r[1],n[2]=r[2]),"rotate3d("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+"deg)"},t.prototype._normalizeAngle=function(e){return e=parseFloat(e,10),isNaN(e)?0:e>89?(i&&console.warn("oriDomi: Maximum value is 89"),89):e<-89?(i&&console.warn("oriDomi: Minimum value is -89"),-89):e},t.prototype._normalizeArgs=function(e,t){var n,r,i,o=this;return r=this._normalizeAngle(t[0]),n=this._getLonghandAnchor(t[1]),i=s(t[2],this._methodDefaults[e]),n!==this.lastAnchor||e==="foldUp"&&this.lastAngle!==0||this.isFoldedUp?(this.reset(function(){return o._showStage(n),setTimeout(function(){return e==="foldUp"&&t.shift(),o[e].apply(o,t)},0)}),!1):(this.lastAngle=r,[r,n,i])},t.prototype._setShader=function(e,t,n){var r,i,s,o;i=Math.abs(n),o=i/90*this.shadingIntensity,this.shading==="hard"?(o*=.15,this.lastAngle<0?n=i:n=-i):o*=.4;switch(t){case"left":case"top":n<0?(r=o,s=0):(r=0,s=o);break;case"right":case"bottom":n<0?(r=0,s=o):(r=o,s=0)}return t==="left"||t==="right"?(this.shaders[t].left[e].style.opacity=r,this.shaders[t].right[e].style.opacity=s):(this.shaders[t].top[e].style.opacity=r,this.shaders[t].bottom[e].style.opacity=s)},t.prototype._getShaderGradient=function(e){return""+n.gradientProp+"("+e+", rgba(0, 0, 0, .5) 0%, rgba(255, 255, 255, .35) 100%)"},t.prototype._showStage=function(e){return this.stages[e].style.display="block",this.stages[this.lastAnchor].style.display="none",this.lastAnchor=e},t.prototype._getPanelType=function(e){return e==="left"||e==="right"?this.vPanels:this.hPanels},t.prototype._getLonghandAnchor=function(e){switch(e){case"left":case"l":case"4":case 4:return"left";case"right":case"r":case"2":case 2:return"right";case"top":case"t":case"1":case 1:return"top";case"bottom":case"b":case"3":case 3:return"bottom";default:return"left"}},t.prototype._methodDefaults={accordion:{sticky:!1,stairs:!1,fracture:!1,twist:!1},curl:{twist:!1},ramp:{},foldUp:{}},t.prototype.reset=function(e){var t,r,i,s,o;if(this.isFoldedUp)return this.unfold(e);o=this.panels[this.lastAnchor];for(t=i=0,s=o.length;i<s;t=++i)r=o[t],r.style[n.transform]=this._transform(0),this.shading&&this._setShader(t,this.lastAnchor,0);return this._callback({callback:e})},t.prototype.accordion=function(e,t,r){var i,s,o,u,a,f,l;o=this._normalizeArgs("accordion",arguments);if(!o)return;e=o[0],t=o[1],r=o[2],l=this.panels[t];for(s=a=0,f=l.length;a<f;s=++a){u=l[s],s%2!==0&&!r.twist?i=-e:i=e;if(r.sticky){if(s===0)i=0;else if(s>1||r.stairs)i*=2}else s!==0&&(i*=2);r.stairs&&(i=-i),u.style[n.transform]=this._transform(i,r.fracture),this.shading&&(s!==0||!r.sticky)&&Math.abs(i)!==180&&this._setShader(s,t,i)}return this._callback(r)},t.prototype.curl=function(e,t,r){var i,s,o,u,a,f;s=this._normalizeArgs("curl",arguments);if(!s)return;e=s[0],t=s[1],r=s[2],e/=this._getPanelType(t),f=this.panels[t];for(i=u=0,a=f.length;u<a;i=++u)o=f[i],o.style[n.transform]=this._transform(e),this.shading&&this._setShader(i,t,0);return this._callback(r)},t.prototype.ramp=function(e,t,r){var i,s,o,u,a,f;s=this._normalizeArgs("ramp",arguments);if(!s)return;e=s[0],t=s[1],r=s[2],this.panels[t][1].style[n.transform]=this._transform(e),f=this.panels[t];for(i=u=0,a=f.length;u<a;i=++u)o=f[i],i>1&&(this.panels[t][i].style[n.transform]=this._transform(0)),this.shading&&this._setShader(i,t,0);return this._callback(r)},t.prototype.foldUp=function(e,t){var r,i,s,o,u,a=this;e?typeof e=="function"&&(t=e):e="left",o=this._normalizeArgs("foldUp",[0,e,{}]);if(!o)return;return e=o[1],this.isFoldedUp=!0,i=this.panels[e].length-1,r=100,s=function(){a.panels[e][i].addEventListener(n.transitionEnd,u,!1),a.panels[e][i].style[n.transform]=a._transform(r);if(a.shading)return a._setShader(i,e,r)},u=function(r){a.panels[e][i].removeEventListener(n.transitionEnd,u,!1),a.panels[e][i].style.display="none";if(--i!==0)return setTimeout(s,0);if(typeof t=="function")return t()},s()},t.prototype.unfold=function(e){var t,r,i,s,o=this;return this.isFoldedUp||typeof e=="function"&&e(),this.isFoldedUp=!1,r=1,t=0,i=function(){return o.panels[o.lastAnchor][r].style.display="block",setTimeout(function(){o.panels[o.lastAnchor][r].addEventListener(n.transitionEnd,s,!1),o.panels[o.lastAnchor][r].style[n.transform]=o._transform(t);if(o.shading)return o._setShader(r,o.lastAnchor,t)},0)},s=function(t){o.panels[o.lastAnchor][r].removeEventListener(n.transitionEnd,s,!1);if(++r!==o.panels[o.lastAnchor].length)return setTimeout(i,0);if(typeof e=="function")return e()},i()},t.prototype.collapse=function(e,t){return t==null&&(t={}),t.sticky=!1,this.accordion(-89,e,t)},t.prototype.collapseAlt=function(e,t){return t==null&&(t={}),t.sticky=!1,this.accordion(89,e,t)},t.prototype.reveal=function(e,t,n){return n==null&&(n={}),n.sticky=!0,this.accordion(e,t,n)},t.prototype.stairs=function(e,t,n){return n==null&&(n={}),n.stairs=!0,n.sticky=!0,this.accordion(e,t,n)},t.prototype.fracture=function(e,t,n){return n==null&&(n={}),n.fracture=!0,this.accordion(e,t,n)},t.prototype.twist=function(e,t,n){return n==null&&(n={}),n.fracture=!0,n.twist=!0,this.accordion(e/10,t,n)},t}(),t.VERSION="0.1.0",t.devMode=function(){return i=!0},f.OriDomi=t,e&&(e.fn.oriDomi=function(n){var r,s,o,a,f,l,c;if(!u)return this;if(typeof n=="string"){if(typeof t.prototype[n]!="function")return i&&console.warn("oriDomi: No such method '"+n+"'");for(a=0,l=this.length;a<l;a++){s=this[a],o=e.data(s,"oriDomi");if(o==null)return i&&console.warn("oriDomi: Can't call "+n+", oriDomi hasn't been initialized on this element");r=Array.prototype.slice.call(arguments),r.shift(),o[n].apply(o,r)}return this}for(f=0,c=this.length;f<c;f++){s=this[f],o=e.data(s,"oriDomi");if(o)return o;e.data(s,"oriDomi",new t(s,n))}return this})}).call(this);